{% extends '__init__/layout.html' %}
{% block content %}
	<style></style>
	<div class="container">
		<h1 class="h2 fw-bolder mt-2">Forecast Days</h1>
		<div id="forcast-container" class="my-2 p-2"></div>
	</div>

	<script>
		if (navigator.geolocation) {
			navigator
				.geolocation
				.getCurrentPosition(function (position) {
					let {latitude, longitude} = position.coords;
					getForcastWeather(`${latitude},${longitude}`)

					async function getForcastWeather(location) {
						fetch(`https://api.weatherapi.com/v1/forecast.json?key=3f66c7588cc14f418bb11203220705&q=${location}&days=7`)
							.then(response => response.json())
							.then(data => {
								let currentday = data.current
								let currentlocation = data.location
								let forcastday = data
									.forecast
									.forecastday
									$("#forcast-container")
									.append(`
							<div class='card m-2 p-2'>
								<img style="width: 100px;height: 100px;" src="${currentday.condition.icon}"></img>
								<h4>${currentday.condition.text}</h4>
								<br>
								<span>name: ${currentlocation.name}</span>
								<span>region: ${currentlocation.region}</span>
								<span>region: ${currentlocation.country}</span>
								<span>humidity: ${currentday.humidity}</span>
								<span>temperature(°C): ${currentday.temp_c}</span>
								<span>temperature(°F ): ${currentday.temp_f}</span>
								<span>wind speed(kph): ${currentday.wind_kph}</span>
								<span>wind speed(mph): ${currentday.wind_mph}</span>
							</div>
							`)
								function formatDate(date) {
									var options = {
										weekday: 'long',
										year: 'numeric',
										month: 'long',
										day: 'numeric',
										time: 'numeric'
									}
									let newDate = new Date(date)
									return newDate.toLocaleDateString("en-US", options)
								}

								forcastday.map((d, i) => {
									currentdayindex = 0
									if (i !== currentdayindex) {
										$("#forcast-container").append(`
								<div class='card m-2 p-2'>
									<span class="h2"> ${formatDate(d.date)}</span>
									<span>humidity: ${d.day.avghumidity}</span>
									<span>average temperature: ${d.day.avgtemp_c}</span>
									<span>average temperature: ${d.day.avgtemp_f}</span>
									<span>maximum wind per miles: ${d.day.maxwind_mph}</span>
									<span>maximum wind per kilometer: ${d.day.maxwind_kph}</span>
									<span>average velocity per kilometer: ${d.day.avgvis_km}</span>
									<span>average velocity per miles: ${d.day.avgvis_miles}</span>
								</div>
							`)
									}

								})

							})
							.catch(err => {
								console.log(err)
							})
						}
				});
		}
	</script>
{% endblock %}